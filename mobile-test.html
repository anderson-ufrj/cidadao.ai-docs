<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Mobile - Cidad√£o.AI</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .test-section h3 {
            margin-top: 0;
            color: #10b981;
        }
        
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .pass { background: #d1fae5; color: #065f46; }
        .fail { background: #fed7e2; color: #9b1c1c; }
        .warning { background: #fef3c7; color: #92400e; }
        
        #results {
            white-space: pre-line;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
        }
        
        button {
            background: #10b981;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        
        button:hover {
            background: #059669;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Teste de Otimiza√ß√µes Mobile - Cidad√£o.AI</h1>
        <p>Esta p√°gina testa as otimiza√ß√µes implementadas para dispositivos m√≥veis.</p>
        
        <div class="test-section">
            <h3>üì± Detec√ß√£o de Dispositivo</h3>
            <p>User Agent: <span id="userAgent"></span></p>
            <p>Largura da tela: <span id="screenWidth"></span>px</p>
            <p>√â m√≥vel: <span id="isMobile" class="status"></span></p>
            <p>Suporte a touch: <span id="isTouch" class="status"></span></p>
        </div>
        
        <div class="test-section">
            <h3>üé® Viewport e CSS</h3>
            <p>Viewport Width: <span id="viewportWidth"></span>px</p>
            <p>Device Pixel Ratio: <span id="pixelRatio"></span></p>
            <p>CSS Custom Properties: <span id="cssProps" class="status"></span></p>
            <p>Safe Area Support: <span id="safeArea" class="status"></span></p>
        </div>
        
        <div class="test-section">
            <h3>üöÄ Performance</h3>
            <p>Service Worker: <span id="serviceWorker" class="status"></span></p>
            <p>Cache API: <span id="cacheAPI" class="status"></span></p>
            <p>Intersection Observer: <span id="intersectionObserver" class="status"></span></p>
            <p>Web App Manifest: <span id="manifest" class="status"></span></p>
        </div>
        
        <div class="test-section">
            <h3>üîå Conectividade</h3>
            <p>Status: <span id="networkStatus" class="status"></span></p>
            <p>Tipo de conex√£o: <span id="connectionType"></span></p>
            <p>Velocidade estimada: <span id="downlink"></span></p>
            <p>Data Saver: <span id="dataSaver" class="status"></span></p>
        </div>
        
        <div class="test-section">
            <h3>üéØ Touch e Gestos</h3>
            <p>Max Touch Points: <span id="maxTouchPoints"></span></p>
            <div id="touchArea" style="background: #e5e7eb; padding: 20px; text-align: center; border-radius: 5px; margin: 10px 0;">
                Toque ou clique aqui para testar
            </div>
            <p>√öltimo evento: <span id="lastTouch"></span></p>
        </div>
        
        <div class="test-section">
            <h3>üß™ Executar Testes</h3>
            <button onclick="runAllTests()">üîç Executar Todos os Testes</button>
            <button onclick="testResponsive()">üì± Testar Responsividade</button>
            <button onclick="testPerformance()">‚ö° Testar Performance</button>
            <button onclick="clearResults()">üßπ Limpar Resultados</button>
        </div>
        
        <div class="test-section">
            <h3>üìä Resultados</h3>
            <div id="results"></div>
        </div>
        
        <div class="test-section">
            <h3>üìã Recomenda√ß√µes</h3>
            <div id="recommendations"></div>
        </div>
    </div>

    <script>
        // Detectar caracter√≠sticas do dispositivo
        function detectDevice() {
            const isMobile = window.innerWidth <= 768 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            
            document.getElementById('userAgent').textContent = navigator.userAgent;
            document.getElementById('screenWidth').textContent = screen.width;
            document.getElementById('viewportWidth').textContent = window.innerWidth;
            document.getElementById('pixelRatio').textContent = window.devicePixelRatio || 1;
            document.getElementById('maxTouchPoints').textContent = navigator.maxTouchPoints || 0;
            
            setStatus('isMobile', isMobile);
            setStatus('isTouch', isTouch);
        }
        
        // Testar suporte a features
        function testFeatures() {
            setStatus('serviceWorker', 'serviceWorker' in navigator);
            setStatus('cacheAPI', 'caches' in window);
            setStatus('intersectionObserver', 'IntersectionObserver' in window);
            setStatus('manifest', 'onbeforeinstallprompt' in window || navigator.standalone !== undefined);
            setStatus('cssProps', CSS.supports('--custom: value'));
            setStatus('safeArea', CSS.supports('padding: env(safe-area-inset-top)'));
        }
        
        // Testar conectividade
        function testConnectivity() {
            const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            
            setStatus('networkStatus', navigator.onLine);
            
            if (connection) {
                document.getElementById('connectionType').textContent = connection.effectiveType || 'Desconhecido';
                document.getElementById('downlink').textContent = (connection.downlink || 0) + ' Mbps';
                setStatus('dataSaver', connection.saveData || false);
            } else {
                document.getElementById('connectionType').textContent = 'API n√£o suportada';
                document.getElementById('downlink').textContent = 'N/A';
                setStatus('dataSaver', false, 'warning');
            }
        }
        
        // Configurar √°rea de teste de touch
        function setupTouchTest() {
            const touchArea = document.getElementById('touchArea');
            const lastTouch = document.getElementById('lastTouch');
            
            touchArea.addEventListener('touchstart', (e) => {
                lastTouch.textContent = `Touch Start (${e.touches.length} pontos)`;
                touchArea.style.background = '#10b981';
                touchArea.style.color = 'white';
            });
            
            touchArea.addEventListener('touchend', (e) => {
                lastTouch.textContent = `Touch End`;
                touchArea.style.background = '#e5e7eb';
                touchArea.style.color = 'black';
            });
            
            touchArea.addEventListener('click', (e) => {
                lastTouch.textContent = `Click (${e.clientX}, ${e.clientY})`;
            });
        }
        
        // Executar todos os testes
        function runAllTests() {
            const results = document.getElementById('results');
            results.textContent = 'Executando testes...\n';
            
            setTimeout(() => {
                testResponsive();
                setTimeout(() => testPerformance(), 500);
                setTimeout(() => generateRecommendations(), 1000);
            }, 100);
        }
        
        // Testar responsividade
        function testResponsive() {
            const results = document.getElementById('results');
            results.textContent += '\n=== TESTE DE RESPONSIVIDADE ===\n';
            
            // Testar breakpoints
            const breakpoints = [320, 480, 768, 1024, 1280];
            breakpoints.forEach(bp => {
                const isActive = window.innerWidth <= bp;
                results.textContent += `Breakpoint ${bp}px: ${isActive ? '‚úÖ Ativo' : '‚ùå Inativo'}\n`;
            });
            
            // Testar elementos responsivos
            const elements = ['navbar', 'hero', 'section'];
            elements.forEach(element => {
                const el = document.querySelector(`.${element}`);
                if (el) {
                    const styles = window.getComputedStyle(el);
                    results.textContent += `${element}: ${styles.padding}\n`;
                }
            });
        }
        
        // Testar performance
        function testPerformance() {
            const results = document.getElementById('results');
            results.textContent += '\n=== TESTE DE PERFORMANCE ===\n';
            
            if ('performance' in window) {
                const timing = performance.timing;
                const loadTime = timing.loadEventEnd - timing.navigationStart;
                results.textContent += `Tempo de carregamento: ${loadTime}ms\n`;
                
                if ('getEntriesByType' in performance) {
                    const resources = performance.getEntriesByType('resource');
                    results.textContent += `Recursos carregados: ${resources.length}\n`;
                    
                    const cssFiles = resources.filter(r => r.name.includes('.css'));
                    results.textContent += `Arquivos CSS: ${cssFiles.length}\n`;
                    
                    const jsFiles = resources.filter(r => r.name.includes('.js'));
                    results.textContent += `Arquivos JS: ${jsFiles.length}\n`;
                }
            }
            
            // Testar FPS (aproximado)
            let frames = 0;
            const startTime = performance.now();
            
            function countFrames() {
                frames++;
                if (performance.now() - startTime < 1000) {
                    requestAnimationFrame(countFrames);
                } else {
                    results.textContent += `FPS estimado: ${frames}\n`;
                }
            }
            
            requestAnimationFrame(countFrames);
        }
        
        // Gerar recomenda√ß√µes
        function generateRecommendations() {
            const recommendations = document.getElementById('recommendations');
            const recs = [];
            
            if (window.innerWidth <= 480) {
                recs.push('üì± Dispositivo m√≥vel pequeno detectado - usando layout compacto');
            }
            
            if (!('serviceWorker' in navigator)) {
                recs.push('‚ö†Ô∏è Service Worker n√£o suportado - cache offline indispon√≠vel');
            }
            
            const connection = navigator.connection;
            if (connection && connection.effectiveType === '2g') {
                recs.push('üêå Conex√£o lenta detectada - ativando modo economia de dados');
            }
            
            if (navigator.maxTouchPoints > 0) {
                recs.push('üëÜ Dispositivo touch - otimiza√ß√µes de toque ativadas');
            }
            
            if (!CSS.supports('--custom: value')) {
                recs.push('‚ùå CSS Custom Properties n√£o suportadas - usando fallbacks');
            }
            
            if (recs.length === 0) {
                recs.push('‚úÖ Todas as otimiza√ß√µes m√≥veis est√£o funcionando corretamente!');
            }
            
            recommendations.innerHTML = recs.map(rec => `<p>${rec}</p>`).join('');
        }
        
        // Limpar resultados
        function clearResults() {
            document.getElementById('results').textContent = '';
            document.getElementById('recommendations').innerHTML = '';
        }
        
        // Utility para definir status
        function setStatus(elementId, condition, type = null) {
            const element = document.getElementById(elementId);
            if (condition === true) {
                element.textContent = '‚úÖ Sim';
                element.className = 'status pass';
            } else if (condition === false) {
                element.textContent = '‚ùå N√£o';
                element.className = 'status fail';
            } else {
                element.textContent = condition;
                element.className = `status ${type || 'warning'}`;
            }
        }
        
        // Inicializar testes
        document.addEventListener('DOMContentLoaded', () => {
            detectDevice();
            testFeatures();
            testConnectivity();
            setupTouchTest();
            
            // Atualizar em mudan√ßas de orienta√ß√£o
            window.addEventListener('orientationchange', () => {
                setTimeout(detectDevice, 500);
            });
            
            // Monitorar mudan√ßas de conex√£o
            window.addEventListener('online', () => setStatus('networkStatus', true));
            window.addEventListener('offline', () => setStatus('networkStatus', false));
        });
    </script>
</body>
</html>